<md-content class="md-padding" ng-controller="MainController">
<h1 class="md-display-2">Current Residents</h1>
<h3 class="md-headline">Welcome, {{userEmail}}</h3>
  <md-input-container id="search-input-container">
    <input type="text" id="search-input" ng-model="searchText">
    <span class="highlight"></span>
    <span class="bar"></span>
    <label>Search by Name</label>
  </md-input-container>


 <v-accordion class="vAccordion--default" onexpand="console.log(index, id)">

 <md-progress-linear md-mode="indeterminate" ng-show="isLoading"></md-progress-linear>

  <v-pane ng-repeat="resident in residents | filter:searchText" expanded="resident.isExpanded" >
    <v-pane-header ng-click="changeUserMessages(resident.id)">
    <div class="residents-container" layout="row">
      <div flex="20">
        <p>{{resident.first_name + ' ' + resident.last_name}}</p>
      </div>
      <div flex="20">
        <p>Phase: {{resident.phase}}</p>
      </div>
      <div flex="60">
        <p> Last Location: {{resident.location.address}} at {{resident.location.time | date : 'shortTime'}} </p>
      </div>
      
    </div>
    
    </v-pane-header>
      

    <v-pane-content>
      <div class="resident-info" id="{{resident.id}}" layout="row">
        <div flex="25">
          <h3 align="center">Chat</h3>
          <!-- <ng-include src="'app/chat/chat.TMPL.html'"></ng-include> -->
          <div class="chat-container" schroll-bottom="messages">
            <div class="messages" ng-repeat="message in messages">
              <div class="message" ng-class="{other: message.userId == myId}">
                <p><strong ng-show="message.userId != myId">{{resident.first_name}}</strong></p><br>
                <span>{{message.text}}</span>
              </div>
            </div>
            <div layout="row" layout-align="center end">
              <md-input-container class="item-input-wrapper">
                <input type="text" placeholder="Type your message" ng-model="message.text"/>
                <md-button class="md-raised" ng-click="sendMessage()">Send</md-button>
              </md-input-container>
            </div>
          </div>
        </div>

        <div flex="50">
          <h3 align="center">Map</h3>

          <div class="resident-map-container">
            <div map-lazy-load="{{googleMapsUrl}}">
              <ng-map center="{{resident.location.latitude}}, {{resident.location.longitude}}" zoom="15">
                <marker position="[{{resident.location.latitude}}, {{resident.location.longitude}}]"></div>
              </ng-map>
            </div>
          </div>

        </div>
      </div>
      
    </v-pane-content>
  </v-pane>

</v-accordion>
</md-content>